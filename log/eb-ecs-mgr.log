2021-06-25T07:37:58Z + . /opt/elasticbeanstalk/hooks/common.sh
2021-06-25T07:37:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_cluster
2021-06-25T07:37:58Z + EB_CONFIG_ECS_CLUSTER=awseb-Bye-env-m44xgakxkp
2021-06-25T07:37:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:37:58Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:37:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_arn_file
2021-06-25T07:37:58Z + EB_CONFIG_ECS_TASK_ARN_FILE=/etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:37:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k deployment_manifest
2021-06-25T07:37:58Z + EB_CONFIG_DEPLOYMENT_MANIFEST=/opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:37:58Z + '[' -f /opt/elasticbeanstalk/deploy/manifest ']'
2021-06-25T07:37:58Z ++ jq -r '.ECS.TaskDefinitionName | select(. != null)'
2021-06-25T07:37:58Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:37:58Z + EB_TASK_DEF_NAME_FROM_MANIFEST=
2021-06-25T07:37:58Z ++ jq -r '.ECS.TaskDefinitionRevision | select(. != null)'
2021-06-25T07:37:58Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:37:58Z + EB_TASK_DEF_REVISION_FROM_MANIFEST=
2021-06-25T07:37:58Z + '[' -z '' ']'
2021-06-25T07:37:58Z + trace 'Could not determine task definition or revision from deployment manifest.'
2021-06-25T07:37:58Z + echo 'Could not determine task definition or revision from deployment manifest.'
2021-06-25T07:37:58Z Could not determine task definition or revision from deployment manifest.
2021-06-25T07:37:58Z + eventHelper.py --msg 'Could not determine task definition or revision from deployment manifest.' --severity TRACE
2021-06-25T07:37:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:37:58Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:37:58Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:37:58Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:37:58Z + CMD_GET_INSTANCE_ARN='curl -sS http://localhost:51678/v1/metadata | jq -r .ContainerInstanceArn'
2021-06-25T07:37:58Z + CMD_GET_KNOWN_STATUS='curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r .KnownStatus'
2021-06-25T07:37:58Z + CMD_DESCRIBE_INSTANCE='aws ecs describe-container-instances --cluster $EB_CONFIG_ECS_CLUSTER --container-instances $EB_CONFIG_ECS_INSTANCE_ARN 2>&1'
2021-06-25T07:37:58Z + case "$1" in
2021-06-25T07:37:58Z + start_ecs_task
2021-06-25T07:37:58Z ++ eval curl -sS http://localhost:51678/v1/metadata '|' jq -r .ContainerInstanceArn
2021-06-25T07:37:58Z +++ jq -r .ContainerInstanceArn
2021-06-25T07:37:58Z +++ curl -sS http://localhost:51678/v1/metadata
2021-06-25T07:37:58Z + local EB_CONFIG_ECS_INSTANCE_ARN=arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:37:58Z + local TIMEOUT=10
2021-06-25T07:37:58Z + '[' -n arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900 ']'
2021-06-25T07:37:58Z + '[' arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900 '!=' null ']'
2021-06-25T07:37:58Z + set +e
2021-06-25T07:37:58Z + local ECS_RESPONSE
2021-06-25T07:37:58Z ++ eval aws ecs describe-container-instances --cluster '$EB_CONFIG_ECS_CLUSTER' --container-instances '$EB_CONFIG_ECS_INSTANCE_ARN' '2>&1'
2021-06-25T07:37:58Z +++ aws ecs describe-container-instances --cluster awseb-Bye-env-m44xgakxkp --container-instances arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:37:59Z + ECS_RESPONSE='{
2021-06-25T07:37:59Z     "failures": [], 
2021-06-25T07:37:59Z     "containerInstances": [
2021-06-25T07:37:59Z         {
2021-06-25T07:37:59Z             "status": "ACTIVE", 
2021-06-25T07:37:59Z             "registeredAt": 1624606625.787, 
2021-06-25T07:37:59Z             "registeredResources": [
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 1024, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "CPU", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 985, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "MEMORY", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [
2021-06-25T07:37:59Z                         "22", 
2021-06-25T07:37:59Z                         "2376", 
2021-06-25T07:37:59Z                         "2375", 
2021-06-25T07:37:59Z                         "51678", 
2021-06-25T07:37:59Z                         "51679"
2021-06-25T07:37:59Z                     ], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }
2021-06-25T07:37:59Z             ], 
2021-06-25T07:37:59Z             "ec2InstanceId": "i-0637a7a81c7137fa2", 
2021-06-25T07:37:59Z             "tags": [], 
2021-06-25T07:37:59Z             "agentConnected": true, 
2021-06-25T07:37:59Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:37:59Z             "pendingTasksCount": 0, 
2021-06-25T07:37:59Z             "remainingResources": [
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 1024, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "CPU", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 985, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "MEMORY", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [
2021-06-25T07:37:59Z                         "22", 
2021-06-25T07:37:59Z                         "2376", 
2021-06-25T07:37:59Z                         "2375", 
2021-06-25T07:37:59Z                         "51678", 
2021-06-25T07:37:59Z                         "51679"
2021-06-25T07:37:59Z                     ], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }
2021-06-25T07:37:59Z             ], 
2021-06-25T07:37:59Z             "version": 3, 
2021-06-25T07:37:59Z             "attributes": [
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.asm.environment-variables"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.ami-id", 
2021-06-25T07:37:59Z                     "value": "ami-0e11fa7aac92a9b5a"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.asm.bootstrap.log-driver"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.task-eia.optimized-cpu"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.none"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.ecr-endpoint"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.docker-plugin.local"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.task-cpu-mem-limit"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.ssm.bootstrap.log-driver"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.efsAuth"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.30"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.full-sync"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.31"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.32"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.fluentd"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.options.config.file"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.availability-zone", 
2021-06-25T07:37:59Z                     "value": "ap-south-1b"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.aws-appmesh"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.24"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.25"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.26"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.27"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.privileged-container"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.28"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.29"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.cpu-architecture", 
2021-06-25T07:37:59Z                     "value": "x86_64"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.ecr-auth"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.fluentbit"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.20"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.os-type", 
2021-06-25T07:37:59Z                     "value": "linux"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.21"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.22"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.task-eia"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.23"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.private-registry-authentication.secretsmanager"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.syslog"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awsfirelens"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.options.config.s3"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.json-file"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.execution-role-awslogs"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.17"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.fluentd"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.efs"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.execution-role-ecr-pull"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.container-health-check"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.instance-type", 
2021-06-25T07:37:59Z                     "value": "t2.micro"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role-network-host"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.container-ordering"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.env-files.s3"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.ssm.environment-variables"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.pid-ipc-namespace-sharing"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role"
2021-06-25T07:37:59Z                 }
2021-06-25T07:37:59Z             ], 
2021-06-25T07:37:59Z             "versionInfo": {
2021-06-25T07:37:59Z                 "agentVersion": "1.51.0", 
2021-06-25T07:37:59Z                 "agentHash": "5c821610", 
2021-06-25T07:37:59Z                 "dockerVersion": "DockerVersion: 19.03.13-ce"
2021-06-25T07:37:59Z             }, 
2021-06-25T07:37:59Z             "runningTasksCount": 0, 
2021-06-25T07:37:59Z             "attachments": []
2021-06-25T07:37:59Z         }
2021-06-25T07:37:59Z     ]
2021-06-25T07:37:59Z }'
2021-06-25T07:37:59Z + '[' 0 -ne 0 ']'
2021-06-25T07:37:59Z ++ jq -r '.containerInstances[0].agentConnected'
2021-06-25T07:37:59Z ++ echo '{
2021-06-25T07:37:59Z     "failures": [], 
2021-06-25T07:37:59Z     "containerInstances": [
2021-06-25T07:37:59Z         {
2021-06-25T07:37:59Z             "status": "ACTIVE", 
2021-06-25T07:37:59Z             "registeredAt": 1624606625.787, 
2021-06-25T07:37:59Z             "registeredResources": [
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 1024, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "CPU", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 985, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "MEMORY", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [
2021-06-25T07:37:59Z                         "22", 
2021-06-25T07:37:59Z                         "2376", 
2021-06-25T07:37:59Z                         "2375", 
2021-06-25T07:37:59Z                         "51678", 
2021-06-25T07:37:59Z                         "51679"
2021-06-25T07:37:59Z                     ], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }
2021-06-25T07:37:59Z             ], 
2021-06-25T07:37:59Z             "ec2InstanceId": "i-0637a7a81c7137fa2", 
2021-06-25T07:37:59Z             "tags": [], 
2021-06-25T07:37:59Z             "agentConnected": true, 
2021-06-25T07:37:59Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:37:59Z             "pendingTasksCount": 0, 
2021-06-25T07:37:59Z             "remainingResources": [
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 1024, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "CPU", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "integerValue": 985, 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "type": "INTEGER", 
2021-06-25T07:37:59Z                     "name": "MEMORY", 
2021-06-25T07:37:59Z                     "doubleValue": 0.0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [
2021-06-25T07:37:59Z                         "22", 
2021-06-25T07:37:59Z                         "2376", 
2021-06-25T07:37:59Z                         "2375", 
2021-06-25T07:37:59Z                         "51678", 
2021-06-25T07:37:59Z                         "51679"
2021-06-25T07:37:59Z                     ], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:37:59Z                     "longValue": 0, 
2021-06-25T07:37:59Z                     "doubleValue": 0.0, 
2021-06-25T07:37:59Z                     "stringSetValue": [], 
2021-06-25T07:37:59Z                     "type": "STRINGSET", 
2021-06-25T07:37:59Z                     "integerValue": 0
2021-06-25T07:37:59Z                 }
2021-06-25T07:37:59Z             ], 
2021-06-25T07:37:59Z             "version": 3, 
2021-06-25T07:37:59Z             "attributes": [
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.asm.environment-variables"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.ami-id", 
2021-06-25T07:37:59Z                     "value": "ami-0e11fa7aac92a9b5a"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.asm.bootstrap.log-driver"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.task-eia.optimized-cpu"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.none"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.ecr-endpoint"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.docker-plugin.local"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.task-cpu-mem-limit"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.ssm.bootstrap.log-driver"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.efsAuth"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.30"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.full-sync"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.31"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.32"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.fluentd"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.options.config.file"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.availability-zone", 
2021-06-25T07:37:59Z                     "value": "ap-south-1b"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.aws-appmesh"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.24"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.25"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.26"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.27"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.privileged-container"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.28"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.29"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.cpu-architecture", 
2021-06-25T07:37:59Z                     "value": "x86_64"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.ecr-auth"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.fluentbit"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.20"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.os-type", 
2021-06-25T07:37:59Z                     "value": "linux"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.21"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.22"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.task-eia"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.23"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.private-registry-authentication.secretsmanager"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.syslog"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awsfirelens"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.options.config.s3"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.json-file"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.execution-role-awslogs"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.17"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.firelens.fluentd"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.efs"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.execution-role-ecr-pull"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.container-health-check"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.instance-type", 
2021-06-25T07:37:59Z                     "value": "t2.micro"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role-network-host"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.container-ordering"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.env-files.s3"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.secrets.ssm.environment-variables"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "ecs.capability.pid-ipc-namespace-sharing"
2021-06-25T07:37:59Z                 }, 
2021-06-25T07:37:59Z                 {
2021-06-25T07:37:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role"
2021-06-25T07:37:59Z                 }
2021-06-25T07:37:59Z             ], 
2021-06-25T07:37:59Z             "versionInfo": {
2021-06-25T07:37:59Z                 "agentVersion": "1.51.0", 
2021-06-25T07:37:59Z                 "agentHash": "5c821610", 
2021-06-25T07:37:59Z                 "dockerVersion": "DockerVersion: 19.03.13-ce"
2021-06-25T07:37:59Z             }, 
2021-06-25T07:37:59Z             "runningTasksCount": 0, 
2021-06-25T07:37:59Z             "attachments": []
2021-06-25T07:37:59Z         }
2021-06-25T07:37:59Z     ]
2021-06-25T07:37:59Z }'
2021-06-25T07:37:59Z + local EB_CONFIG_ECS_AGENT_CONNECTED=true
2021-06-25T07:37:59Z + local TIMEOUT=20
2021-06-25T07:37:59Z + '[' true = true ']'
2021-06-25T07:37:59Z + set -e
2021-06-25T07:37:59Z + trace 'Starting new ECS task with awseb-Bye-env-m44xgakxkp.'
2021-06-25T07:37:59Z + echo 'Starting new ECS task with awseb-Bye-env-m44xgakxkp.'
2021-06-25T07:37:59Z Starting new ECS task with awseb-Bye-env-m44xgakxkp.
2021-06-25T07:37:59Z + eventHelper.py --msg 'Starting new ECS task with awseb-Bye-env-m44xgakxkp.' --severity TRACE
2021-06-25T07:37:59Z + set +e
2021-06-25T07:37:59Z + local ECS_RESPONSE
2021-06-25T07:37:59Z ++ aws ecs start-task --cluster awseb-Bye-env-m44xgakxkp --task-definition awseb-Bye-env-m44xgakxkp --container-instances arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:38:00Z + ECS_RESPONSE='{
2021-06-25T07:38:00Z     "failures": [], 
2021-06-25T07:38:00Z     "tasks": [
2021-06-25T07:38:00Z         {
2021-06-25T07:38:00Z             "availabilityZone": "ap-south-1b", 
2021-06-25T07:38:00Z             "group": "family:awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:38:00Z             "attachments": [], 
2021-06-25T07:38:00Z             "tags": [], 
2021-06-25T07:38:00Z             "overrides": {
2021-06-25T07:38:00Z                 "inferenceAcceleratorOverrides": [], 
2021-06-25T07:38:00Z                 "containerOverrides": [
2021-06-25T07:38:00Z                     {
2021-06-25T07:38:00Z                         "name": "nginx-proxy"
2021-06-25T07:38:00Z                     }, 
2021-06-25T07:38:00Z                     {
2021-06-25T07:38:00Z                         "name": "php-app"
2021-06-25T07:38:00Z                     }
2021-06-25T07:38:00Z                 ]
2021-06-25T07:38:00Z             }, 
2021-06-25T07:38:00Z             "lastStatus": "PENDING", 
2021-06-25T07:38:00Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:38:00Z             "createdAt": 1624606679.971, 
2021-06-25T07:38:00Z             "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:38:00Z             "launchType": "EC2", 
2021-06-25T07:38:00Z             "clusterArn": "arn:aws:ecs:ap-south-1:215680092654:cluster/awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:38:00Z             "version": 1, 
2021-06-25T07:38:00Z             "memory": "256", 
2021-06-25T07:38:00Z             "desiredStatus": "RUNNING", 
2021-06-25T07:38:00Z             "taskDefinitionArn": "arn:aws:ecs:ap-south-1:215680092654:task-definition/awseb-Bye-env-m44xgakxkp:1", 
2021-06-25T07:38:00Z             "cpu": "0", 
2021-06-25T07:38:00Z             "containers": [
2021-06-25T07:38:00Z                 {
2021-06-25T07:38:00Z                     "containerArn": "arn:aws:ecs:ap-south-1:215680092654:container/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9/0cff70d4-886a-4a8e-90b4-3f6bbeeb4b45", 
2021-06-25T07:38:00Z                     "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:38:00Z                     "name": "php-app", 
2021-06-25T07:38:00Z                     "image": "php:fpm", 
2021-06-25T07:38:00Z                     "lastStatus": "PENDING", 
2021-06-25T07:38:00Z                     "memory": "128", 
2021-06-25T07:38:00Z                     "cpu": "0", 
2021-06-25T07:38:00Z                     "networkInterfaces": []
2021-06-25T07:38:00Z                 }, 
2021-06-25T07:38:00Z                 {
2021-06-25T07:38:00Z                     "containerArn": "arn:aws:ecs:ap-south-1:215680092654:container/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9/098b7c64-3a7d-4e67-8c9a-d07dd808346b", 
2021-06-25T07:38:00Z                     "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:38:00Z                     "name": "nginx-proxy", 
2021-06-25T07:38:00Z                     "image": "nginx", 
2021-06-25T07:38:00Z                     "lastStatus": "PENDING", 
2021-06-25T07:38:00Z                     "memory": "128", 
2021-06-25T07:38:00Z                     "cpu": "0", 
2021-06-25T07:38:00Z                     "networkInterfaces": []
2021-06-25T07:38:00Z                 }
2021-06-25T07:38:00Z             ]
2021-06-25T07:38:00Z         }
2021-06-25T07:38:00Z     ]
2021-06-25T07:38:00Z }'
2021-06-25T07:38:00Z + local ECS_EXIT=0
2021-06-25T07:38:00Z ++ jq -r '.tasks[0].taskArn'
2021-06-25T07:38:00Z ++ echo '{
2021-06-25T07:38:00Z     "failures": [], 
2021-06-25T07:38:00Z     "tasks": [
2021-06-25T07:38:00Z         {
2021-06-25T07:38:00Z             "availabilityZone": "ap-south-1b", 
2021-06-25T07:38:00Z             "group": "family:awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:38:00Z             "attachments": [], 
2021-06-25T07:38:00Z             "tags": [], 
2021-06-25T07:38:00Z             "overrides": {
2021-06-25T07:38:00Z                 "inferenceAcceleratorOverrides": [], 
2021-06-25T07:38:00Z                 "containerOverrides": [
2021-06-25T07:38:00Z                     {
2021-06-25T07:38:00Z                         "name": "nginx-proxy"
2021-06-25T07:38:00Z                     }, 
2021-06-25T07:38:00Z                     {
2021-06-25T07:38:00Z                         "name": "php-app"
2021-06-25T07:38:00Z                     }
2021-06-25T07:38:00Z                 ]
2021-06-25T07:38:00Z             }, 
2021-06-25T07:38:00Z             "lastStatus": "PENDING", 
2021-06-25T07:38:00Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:38:00Z             "createdAt": 1624606679.971, 
2021-06-25T07:38:00Z             "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:38:00Z             "launchType": "EC2", 
2021-06-25T07:38:00Z             "clusterArn": "arn:aws:ecs:ap-south-1:215680092654:cluster/awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:38:00Z             "version": 1, 
2021-06-25T07:38:00Z             "memory": "256", 
2021-06-25T07:38:00Z             "desiredStatus": "RUNNING", 
2021-06-25T07:38:00Z             "taskDefinitionArn": "arn:aws:ecs:ap-south-1:215680092654:task-definition/awseb-Bye-env-m44xgakxkp:1", 
2021-06-25T07:38:00Z             "cpu": "0", 
2021-06-25T07:38:00Z             "containers": [
2021-06-25T07:38:00Z                 {
2021-06-25T07:38:00Z                     "containerArn": "arn:aws:ecs:ap-south-1:215680092654:container/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9/0cff70d4-886a-4a8e-90b4-3f6bbeeb4b45", 
2021-06-25T07:38:00Z                     "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:38:00Z                     "name": "php-app", 
2021-06-25T07:38:00Z                     "image": "php:fpm", 
2021-06-25T07:38:00Z                     "lastStatus": "PENDING", 
2021-06-25T07:38:00Z                     "memory": "128", 
2021-06-25T07:38:00Z                     "cpu": "0", 
2021-06-25T07:38:00Z                     "networkInterfaces": []
2021-06-25T07:38:00Z                 }, 
2021-06-25T07:38:00Z                 {
2021-06-25T07:38:00Z                     "containerArn": "arn:aws:ecs:ap-south-1:215680092654:container/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9/098b7c64-3a7d-4e67-8c9a-d07dd808346b", 
2021-06-25T07:38:00Z                     "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:38:00Z                     "name": "nginx-proxy", 
2021-06-25T07:38:00Z                     "image": "nginx", 
2021-06-25T07:38:00Z                     "lastStatus": "PENDING", 
2021-06-25T07:38:00Z                     "memory": "128", 
2021-06-25T07:38:00Z                     "cpu": "0", 
2021-06-25T07:38:00Z                     "networkInterfaces": []
2021-06-25T07:38:00Z                 }
2021-06-25T07:38:00Z             ]
2021-06-25T07:38:00Z         }
2021-06-25T07:38:00Z     ]
2021-06-25T07:38:00Z }'
2021-06-25T07:38:00Z + local EB_CONFIG_ECS_TASK_ARN=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:38:00Z + '[' 0 -ne 0 ']'
2021-06-25T07:38:00Z + '[' -z arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 ']'
2021-06-25T07:38:00Z + '[' arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 = null ']'
2021-06-25T07:38:00Z + set -e
2021-06-25T07:38:00Z + echo arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:38:00Z + local START_TIMEOUT=840
2021-06-25T07:38:00Z + local TIMEOUT=840
2021-06-25T07:38:00Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:00Z +++ jq -r .KnownStatus
2021-06-25T07:38:00Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:00Z + local KNOWN_STATUS=
2021-06-25T07:38:00Z + '[' '' '!=' RUNNING ']'
2021-06-25T07:38:00Z + '[' -z '' ']'
2021-06-25T07:38:00Z + sleep 3
2021-06-25T07:38:03Z + TIMEOUT=837
2021-06-25T07:38:03Z + '[' 837 -le 0 ']'
2021-06-25T07:38:03Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:03Z +++ jq -r .KnownStatus
2021-06-25T07:38:03Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:03Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:03Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:03Z + '[' -z PENDING ']'
2021-06-25T07:38:03Z + '[' PENDING = NONE ']'
2021-06-25T07:38:03Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:03Z + sleep 3
2021-06-25T07:38:06Z + TIMEOUT=834
2021-06-25T07:38:06Z + '[' 834 -le 0 ']'
2021-06-25T07:38:06Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:06Z +++ jq -r .KnownStatus
2021-06-25T07:38:06Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:06Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:06Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:06Z + '[' -z PENDING ']'
2021-06-25T07:38:06Z + '[' PENDING = NONE ']'
2021-06-25T07:38:06Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:06Z + sleep 3
2021-06-25T07:38:09Z + TIMEOUT=831
2021-06-25T07:38:09Z + '[' 831 -le 0 ']'
2021-06-25T07:38:09Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:09Z +++ jq -r .KnownStatus
2021-06-25T07:38:09Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:09Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:09Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:09Z + '[' -z PENDING ']'
2021-06-25T07:38:09Z + '[' PENDING = NONE ']'
2021-06-25T07:38:09Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:09Z + sleep 3
2021-06-25T07:38:12Z + TIMEOUT=828
2021-06-25T07:38:12Z + '[' 828 -le 0 ']'
2021-06-25T07:38:12Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:12Z +++ jq -r .KnownStatus
2021-06-25T07:38:12Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:12Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:12Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:12Z + '[' -z PENDING ']'
2021-06-25T07:38:12Z + '[' PENDING = NONE ']'
2021-06-25T07:38:12Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:12Z + sleep 3
2021-06-25T07:38:15Z + TIMEOUT=825
2021-06-25T07:38:15Z + '[' 825 -le 0 ']'
2021-06-25T07:38:15Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:15Z +++ jq -r .KnownStatus
2021-06-25T07:38:15Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:15Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:15Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:15Z + '[' -z PENDING ']'
2021-06-25T07:38:15Z + '[' PENDING = NONE ']'
2021-06-25T07:38:15Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:15Z + sleep 3
2021-06-25T07:38:18Z + TIMEOUT=822
2021-06-25T07:38:18Z + '[' 822 -le 0 ']'
2021-06-25T07:38:18Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:18Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:18Z +++ jq -r .KnownStatus
2021-06-25T07:38:18Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:18Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:18Z + '[' -z PENDING ']'
2021-06-25T07:38:18Z + '[' PENDING = NONE ']'
2021-06-25T07:38:18Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:18Z + sleep 3
2021-06-25T07:38:21Z + TIMEOUT=819
2021-06-25T07:38:21Z + '[' 819 -le 0 ']'
2021-06-25T07:38:21Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:21Z +++ jq -r .KnownStatus
2021-06-25T07:38:21Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:21Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:21Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:21Z + '[' -z PENDING ']'
2021-06-25T07:38:21Z + '[' PENDING = NONE ']'
2021-06-25T07:38:21Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:21Z + sleep 3
2021-06-25T07:38:24Z + TIMEOUT=816
2021-06-25T07:38:24Z + '[' 816 -le 0 ']'
2021-06-25T07:38:24Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:24Z +++ jq -r .KnownStatus
2021-06-25T07:38:24Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:24Z + KNOWN_STATUS=PENDING
2021-06-25T07:38:24Z + '[' PENDING '!=' RUNNING ']'
2021-06-25T07:38:24Z + '[' -z PENDING ']'
2021-06-25T07:38:24Z + '[' PENDING = NONE ']'
2021-06-25T07:38:24Z + '[' PENDING = PENDING ']'
2021-06-25T07:38:24Z + sleep 3
2021-06-25T07:38:27Z + TIMEOUT=813
2021-06-25T07:38:27Z + '[' 813 -le 0 ']'
2021-06-25T07:38:27Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:38:27Z +++ jq -r .KnownStatus
2021-06-25T07:38:27Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:27Z + KNOWN_STATUS=RUNNING
2021-06-25T07:38:27Z + '[' RUNNING '!=' RUNNING ']'
2021-06-25T07:38:27Z ++ jq -r -c '.Containers[] | .DockerId + "," + .Name'
2021-06-25T07:38:27Z ++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:38:27Z + for CONTAINER in '`curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r -c '\''.Containers[] | .DockerId + "," + .Name'\''`'
2021-06-25T07:38:27Z ++ cut -c 1-12
2021-06-25T07:38:27Z ++ awk -F , '{print $1}'
2021-06-25T07:38:27Z ++ echo 0bb212c8d979f861f78ee4029709e05a35795fe890b93c11380c83464f3aa448,php-app
2021-06-25T07:38:27Z + CONTAINER_ID=0bb212c8d979
2021-06-25T07:38:27Z ++ awk -F , '{print $2}'
2021-06-25T07:38:27Z ++ echo 0bb212c8d979f861f78ee4029709e05a35795fe890b93c11380c83464f3aa448,php-app
2021-06-25T07:38:27Z + CONTAINER_NAME=php-app
2021-06-25T07:38:27Z + for CONTAINER in '`curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r -c '\''.Containers[] | .DockerId + "," + .Name'\''`'
2021-06-25T07:38:27Z + docker logs -f 0bb212c8d979
2021-06-25T07:38:27Z ++ cut -c 1-12
2021-06-25T07:38:27Z ++ awk -F , '{print $1}'
2021-06-25T07:38:27Z ++ echo a43181cf453840d0f3a3f8f1468d0d91eabd14734479be4d048f5df9db91687b,nginx-proxy
2021-06-25T07:38:27Z + CONTAINER_ID=a43181cf4538
2021-06-25T07:38:27Z ++ awk -F , '{print $2}'
2021-06-25T07:38:27Z ++ echo a43181cf453840d0f3a3f8f1468d0d91eabd14734479be4d048f5df9db91687b,nginx-proxy
2021-06-25T07:38:27Z + CONTAINER_NAME=nginx-proxy
2021-06-25T07:38:27Z + trace 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is RUNNING.'
2021-06-25T07:38:27Z + echo 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is RUNNING.'
2021-06-25T07:38:27Z ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is RUNNING.
2021-06-25T07:38:27Z + eventHelper.py --msg 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is RUNNING.' --severity TRACE
2021-06-25T07:38:27Z + docker logs -f a43181cf4538
2021-06-25T07:38:27Z + exit 0
2021-06-25T07:45:49Z + . /opt/elasticbeanstalk/hooks/common.sh
2021-06-25T07:45:49Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_cluster
2021-06-25T07:45:49Z + EB_CONFIG_ECS_CLUSTER=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:49Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:45:49Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:49Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_arn_file
2021-06-25T07:45:49Z + EB_CONFIG_ECS_TASK_ARN_FILE=/etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:45:49Z ++ /opt/elasticbeanstalk/bin/get-config container -k deployment_manifest
2021-06-25T07:45:49Z + EB_CONFIG_DEPLOYMENT_MANIFEST=/opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:49Z + '[' -f /opt/elasticbeanstalk/deploy/manifest ']'
2021-06-25T07:45:49Z ++ jq -r '.ECS.TaskDefinitionName | select(. != null)'
2021-06-25T07:45:49Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:49Z + EB_TASK_DEF_NAME_FROM_MANIFEST=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:49Z ++ jq -r '.ECS.TaskDefinitionRevision | select(. != null)'
2021-06-25T07:45:49Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:49Z + EB_TASK_DEF_REVISION_FROM_MANIFEST=2
2021-06-25T07:45:49Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:49Z + '[' -z 2 ']'
2021-06-25T07:45:49Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp:2
2021-06-25T07:45:49Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:49Z + '[' -z awseb-Bye-env-m44xgakxkp:2 ']'
2021-06-25T07:45:49Z + CMD_GET_INSTANCE_ARN='curl -sS http://localhost:51678/v1/metadata | jq -r .ContainerInstanceArn'
2021-06-25T07:45:49Z + CMD_GET_KNOWN_STATUS='curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r .KnownStatus'
2021-06-25T07:45:49Z + CMD_DESCRIBE_INSTANCE='aws ecs describe-container-instances --cluster $EB_CONFIG_ECS_CLUSTER --container-instances $EB_CONFIG_ECS_INSTANCE_ARN 2>&1'
2021-06-25T07:45:49Z + case "$1" in
2021-06-25T07:45:49Z + stop_ecs_task
2021-06-25T07:45:49Z + '[' -f /etc/elasticbeanstalk/.ecs-task-arn ']'
2021-06-25T07:45:49Z ++ cat /etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:45:49Z + local EB_CONFIG_ECS_TASK_ARN=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:45:49Z + trace 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.'
2021-06-25T07:45:49Z + echo 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.'
2021-06-25T07:45:49Z Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.
2021-06-25T07:45:49Z + eventHelper.py --msg 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.' --severity TRACE
2021-06-25T07:45:49Z + set +e
2021-06-25T07:45:49Z + local ECS_RESPONSE
2021-06-25T07:45:49Z ++ aws ecs stop-task --cluster awseb-Bye-env-m44xgakxkp --task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:45:50Z + ECS_RESPONSE='{
2021-06-25T07:45:50Z     "task": {
2021-06-25T07:45:50Z         "launchType": "EC2", 
2021-06-25T07:45:50Z         "attachments": [], 
2021-06-25T07:45:50Z         "stoppingAt": 1624607150.105, 
2021-06-25T07:45:50Z         "clusterArn": "arn:aws:ecs:ap-south-1:215680092654:cluster/awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:45:50Z         "desiredStatus": "STOPPED", 
2021-06-25T07:45:50Z         "createdAt": 1624606679.971, 
2021-06-25T07:45:50Z         "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:45:50Z         "group": "family:awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:45:50Z         "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:45:50Z         "pullStartedAt": 1624606681.038, 
2021-06-25T07:45:50Z         "version": 4, 
2021-06-25T07:45:50Z         "stopCode": "UserInitiated", 
2021-06-25T07:45:50Z         "connectivityAt": 1624606679.971, 
2021-06-25T07:45:50Z         "startedAt": 1624606704.771, 
2021-06-25T07:45:50Z         "taskDefinitionArn": "arn:aws:ecs:ap-south-1:215680092654:task-definition/awseb-Bye-env-m44xgakxkp:1", 
2021-06-25T07:45:50Z         "containers": [
2021-06-25T07:45:50Z             {
2021-06-25T07:45:50Z                 "containerArn": "arn:aws:ecs:ap-south-1:215680092654:container/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9/098b7c64-3a7d-4e67-8c9a-d07dd808346b", 
2021-06-25T07:45:50Z                 "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:45:50Z                 "name": "nginx-proxy", 
2021-06-25T07:45:50Z                 "networkBindings": [
2021-06-25T07:45:50Z                     {
2021-06-25T07:45:50Z                         "protocol": "tcp", 
2021-06-25T07:45:50Z                         "bindIP": "0.0.0.0", 
2021-06-25T07:45:50Z                         "containerPort": 80, 
2021-06-25T07:45:50Z                         "hostPort": 80
2021-06-25T07:45:50Z                     }
2021-06-25T07:45:50Z                 ], 
2021-06-25T07:45:50Z                 "image": "nginx", 
2021-06-25T07:45:50Z                 "lastStatus": "RUNNING", 
2021-06-25T07:45:50Z                 "memory": "128", 
2021-06-25T07:45:50Z                 "runtimeId": "a43181cf453840d0f3a3f8f1468d0d91eabd14734479be4d048f5df9db91687b", 
2021-06-25T07:45:50Z                 "cpu": "0", 
2021-06-25T07:45:50Z                 "networkInterfaces": []
2021-06-25T07:45:50Z             }, 
2021-06-25T07:45:50Z             {
2021-06-25T07:45:50Z                 "containerArn": "arn:aws:ecs:ap-south-1:215680092654:container/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9/0cff70d4-886a-4a8e-90b4-3f6bbeeb4b45", 
2021-06-25T07:45:50Z                 "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:45:50Z                 "name": "php-app", 
2021-06-25T07:45:50Z                 "networkBindings": [], 
2021-06-25T07:45:50Z                 "image": "php:fpm", 
2021-06-25T07:45:50Z                 "lastStatus": "RUNNING", 
2021-06-25T07:45:50Z                 "memory": "128", 
2021-06-25T07:45:50Z                 "runtimeId": "0bb212c8d979f861f78ee4029709e05a35795fe890b93c11380c83464f3aa448", 
2021-06-25T07:45:50Z                 "cpu": "0", 
2021-06-25T07:45:50Z                 "networkInterfaces": []
2021-06-25T07:45:50Z             }
2021-06-25T07:45:50Z         ], 
2021-06-25T07:45:50Z         "availabilityZone": "ap-south-1b", 
2021-06-25T07:45:50Z         "tags": [], 
2021-06-25T07:45:50Z         "memory": "256", 
2021-06-25T07:45:50Z         "lastStatus": "RUNNING", 
2021-06-25T07:45:50Z         "connectivity": "CONNECTED", 
2021-06-25T07:45:50Z         "overrides": {
2021-06-25T07:45:50Z             "inferenceAcceleratorOverrides": [], 
2021-06-25T07:45:50Z             "containerOverrides": [
2021-06-25T07:45:50Z                 {
2021-06-25T07:45:50Z                     "name": "nginx-proxy"
2021-06-25T07:45:50Z                 }, 
2021-06-25T07:45:50Z                 {
2021-06-25T07:45:50Z                     "name": "php-app"
2021-06-25T07:45:50Z                 }
2021-06-25T07:45:50Z             ]
2021-06-25T07:45:50Z         }, 
2021-06-25T07:45:50Z         "pullStoppedAt": 1624606704.509, 
2021-06-25T07:45:50Z         "stoppedReason": "Task stopped by user", 
2021-06-25T07:45:50Z         "cpu": "0"
2021-06-25T07:45:50Z     }
2021-06-25T07:45:50Z }'
2021-06-25T07:45:50Z + '[' 0 -ne 0 ']'
2021-06-25T07:45:50Z + set -e
2021-06-25T07:45:50Z + local STOP_TIMEOUT=120
2021-06-25T07:45:50Z + local TIMEOUT=120
2021-06-25T07:45:50Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:45:50Z +++ jq -r .KnownStatus
2021-06-25T07:45:50Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:45:50Z + local KNOWN_STATUS=RUNNING
2021-06-25T07:45:50Z + '[' RUNNING '!=' STOPPED ']'
2021-06-25T07:45:50Z + '[' RUNNING '!=' DEAD ']'
2021-06-25T07:45:50Z + sleep 3
2021-06-25T07:45:53Z + TIMEOUT=117
2021-06-25T07:45:53Z + '[' 117 -le 0 ']'
2021-06-25T07:45:53Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:45:53Z +++ jq -r .KnownStatus
2021-06-25T07:45:53Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:45:53Z + KNOWN_STATUS=STOPPED
2021-06-25T07:45:53Z + '[' STOPPED '!=' STOPPED ']'
2021-06-25T07:45:53Z + trace 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.'
2021-06-25T07:45:53Z + echo 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.'
2021-06-25T07:45:53Z ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.
2021-06-25T07:45:53Z + eventHelper.py --msg 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.' --severity TRACE
2021-06-25T07:45:53Z + TIMEOUT=60
2021-06-25T07:45:53Z ++ wc -l
2021-06-25T07:45:53Z ++ docker ps -q
2021-06-25T07:45:53Z + '[' 1 '!=' 1 ']'
2021-06-25T07:45:53Z + exit 0
2021-06-25T07:45:53Z + . /opt/elasticbeanstalk/hooks/common.sh
2021-06-25T07:45:53Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_cluster
2021-06-25T07:45:53Z + EB_CONFIG_ECS_CLUSTER=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:53Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:45:53Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:53Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_arn_file
2021-06-25T07:45:53Z + EB_CONFIG_ECS_TASK_ARN_FILE=/etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:45:53Z ++ /opt/elasticbeanstalk/bin/get-config container -k deployment_manifest
2021-06-25T07:45:54Z + EB_CONFIG_DEPLOYMENT_MANIFEST=/opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:54Z + '[' -f /opt/elasticbeanstalk/deploy/manifest ']'
2021-06-25T07:45:54Z ++ jq -r '.ECS.TaskDefinitionName | select(. != null)'
2021-06-25T07:45:54Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:54Z + EB_TASK_DEF_NAME_FROM_MANIFEST=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:54Z ++ jq -r '.ECS.TaskDefinitionRevision | select(. != null)'
2021-06-25T07:45:54Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:54Z + EB_TASK_DEF_REVISION_FROM_MANIFEST=2
2021-06-25T07:45:54Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:54Z + '[' -z 2 ']'
2021-06-25T07:45:54Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp:2
2021-06-25T07:45:54Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:54Z + '[' -z awseb-Bye-env-m44xgakxkp:2 ']'
2021-06-25T07:45:54Z + CMD_GET_INSTANCE_ARN='curl -sS http://localhost:51678/v1/metadata | jq -r .ContainerInstanceArn'
2021-06-25T07:45:54Z + CMD_GET_KNOWN_STATUS='curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r .KnownStatus'
2021-06-25T07:45:54Z + CMD_DESCRIBE_INSTANCE='aws ecs describe-container-instances --cluster $EB_CONFIG_ECS_CLUSTER --container-instances $EB_CONFIG_ECS_INSTANCE_ARN 2>&1'
2021-06-25T07:45:54Z + case "$1" in
2021-06-25T07:45:54Z + start_ecs_task
2021-06-25T07:45:54Z ++ eval curl -sS http://localhost:51678/v1/metadata '|' jq -r .ContainerInstanceArn
2021-06-25T07:45:54Z +++ jq -r .ContainerInstanceArn
2021-06-25T07:45:54Z +++ curl -sS http://localhost:51678/v1/metadata
2021-06-25T07:45:54Z + local EB_CONFIG_ECS_INSTANCE_ARN=arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:45:54Z + local TIMEOUT=10
2021-06-25T07:45:54Z + '[' -n arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900 ']'
2021-06-25T07:45:54Z + '[' arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900 '!=' null ']'
2021-06-25T07:45:54Z + set +e
2021-06-25T07:45:54Z + local ECS_RESPONSE
2021-06-25T07:45:54Z ++ eval aws ecs describe-container-instances --cluster '$EB_CONFIG_ECS_CLUSTER' --container-instances '$EB_CONFIG_ECS_INSTANCE_ARN' '2>&1'
2021-06-25T07:45:54Z +++ aws ecs describe-container-instances --cluster awseb-Bye-env-m44xgakxkp --container-instances arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:45:54Z + ECS_RESPONSE='{
2021-06-25T07:45:54Z     "failures": [], 
2021-06-25T07:45:54Z     "containerInstances": [
2021-06-25T07:45:54Z         {
2021-06-25T07:45:54Z             "status": "ACTIVE", 
2021-06-25T07:45:54Z             "registeredAt": 1624606625.787, 
2021-06-25T07:45:54Z             "registeredResources": [
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 1024, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "CPU", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 985, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "MEMORY", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [
2021-06-25T07:45:54Z                         "22", 
2021-06-25T07:45:54Z                         "2376", 
2021-06-25T07:45:54Z                         "2375", 
2021-06-25T07:45:54Z                         "51678", 
2021-06-25T07:45:54Z                         "51679"
2021-06-25T07:45:54Z                     ], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }
2021-06-25T07:45:54Z             ], 
2021-06-25T07:45:54Z             "ec2InstanceId": "i-0637a7a81c7137fa2", 
2021-06-25T07:45:54Z             "tags": [], 
2021-06-25T07:45:54Z             "agentConnected": true, 
2021-06-25T07:45:54Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:45:54Z             "pendingTasksCount": 0, 
2021-06-25T07:45:54Z             "remainingResources": [
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 1024, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "CPU", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 985, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "MEMORY", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [
2021-06-25T07:45:54Z                         "22", 
2021-06-25T07:45:54Z                         "2376", 
2021-06-25T07:45:54Z                         "2375", 
2021-06-25T07:45:54Z                         "51678", 
2021-06-25T07:45:54Z                         "51679"
2021-06-25T07:45:54Z                     ], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }
2021-06-25T07:45:54Z             ], 
2021-06-25T07:45:54Z             "version": 5, 
2021-06-25T07:45:54Z             "attributes": [
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.asm.environment-variables"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.ami-id", 
2021-06-25T07:45:54Z                     "value": "ami-0e11fa7aac92a9b5a"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.asm.bootstrap.log-driver"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.task-eia.optimized-cpu"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.none"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.ecr-endpoint"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.docker-plugin.local"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.task-cpu-mem-limit"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.ssm.bootstrap.log-driver"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.efsAuth"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.30"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.full-sync"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.31"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.32"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.fluentd"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.options.config.file"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.availability-zone", 
2021-06-25T07:45:54Z                     "value": "ap-south-1b"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.aws-appmesh"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.24"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.25"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.26"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.27"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.privileged-container"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.28"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.29"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.cpu-architecture", 
2021-06-25T07:45:54Z                     "value": "x86_64"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.ecr-auth"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.fluentbit"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.20"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.os-type", 
2021-06-25T07:45:54Z                     "value": "linux"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.21"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.22"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.task-eia"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.23"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.private-registry-authentication.secretsmanager"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.syslog"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awsfirelens"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.options.config.s3"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.json-file"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.execution-role-awslogs"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.17"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.fluentd"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.efs"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.execution-role-ecr-pull"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.container-health-check"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.instance-type", 
2021-06-25T07:45:54Z                     "value": "t2.micro"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.task-iam-role-network-host"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.container-ordering"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.env-files.s3"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.ssm.environment-variables"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.pid-ipc-namespace-sharing"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.task-iam-role"
2021-06-25T07:45:54Z                 }
2021-06-25T07:45:54Z             ], 
2021-06-25T07:45:54Z             "versionInfo": {
2021-06-25T07:45:54Z                 "agentVersion": "1.51.0", 
2021-06-25T07:45:54Z                 "agentHash": "5c821610", 
2021-06-25T07:45:54Z                 "dockerVersion": "DockerVersion: 19.03.13-ce"
2021-06-25T07:45:54Z             }, 
2021-06-25T07:45:54Z             "runningTasksCount": 0, 
2021-06-25T07:45:54Z             "attachments": []
2021-06-25T07:45:54Z         }
2021-06-25T07:45:54Z     ]
2021-06-25T07:45:54Z }'
2021-06-25T07:45:54Z + '[' 0 -ne 0 ']'
2021-06-25T07:45:54Z ++ jq -r '.containerInstances[0].agentConnected'
2021-06-25T07:45:54Z ++ echo '{
2021-06-25T07:45:54Z     "failures": [], 
2021-06-25T07:45:54Z     "containerInstances": [
2021-06-25T07:45:54Z         {
2021-06-25T07:45:54Z             "status": "ACTIVE", 
2021-06-25T07:45:54Z             "registeredAt": 1624606625.787, 
2021-06-25T07:45:54Z             "registeredResources": [
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 1024, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "CPU", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 985, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "MEMORY", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [
2021-06-25T07:45:54Z                         "22", 
2021-06-25T07:45:54Z                         "2376", 
2021-06-25T07:45:54Z                         "2375", 
2021-06-25T07:45:54Z                         "51678", 
2021-06-25T07:45:54Z                         "51679"
2021-06-25T07:45:54Z                     ], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }
2021-06-25T07:45:54Z             ], 
2021-06-25T07:45:54Z             "ec2InstanceId": "i-0637a7a81c7137fa2", 
2021-06-25T07:45:54Z             "tags": [], 
2021-06-25T07:45:54Z             "agentConnected": true, 
2021-06-25T07:45:54Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:45:54Z             "pendingTasksCount": 0, 
2021-06-25T07:45:54Z             "remainingResources": [
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 1024, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "CPU", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "integerValue": 985, 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "type": "INTEGER", 
2021-06-25T07:45:54Z                     "name": "MEMORY", 
2021-06-25T07:45:54Z                     "doubleValue": 0.0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [
2021-06-25T07:45:54Z                         "22", 
2021-06-25T07:45:54Z                         "2376", 
2021-06-25T07:45:54Z                         "2375", 
2021-06-25T07:45:54Z                         "51678", 
2021-06-25T07:45:54Z                         "51679"
2021-06-25T07:45:54Z                     ], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:54Z                     "longValue": 0, 
2021-06-25T07:45:54Z                     "doubleValue": 0.0, 
2021-06-25T07:45:54Z                     "stringSetValue": [], 
2021-06-25T07:45:54Z                     "type": "STRINGSET", 
2021-06-25T07:45:54Z                     "integerValue": 0
2021-06-25T07:45:54Z                 }
2021-06-25T07:45:54Z             ], 
2021-06-25T07:45:54Z             "version": 5, 
2021-06-25T07:45:54Z             "attributes": [
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.asm.environment-variables"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.ami-id", 
2021-06-25T07:45:54Z                     "value": "ami-0e11fa7aac92a9b5a"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.asm.bootstrap.log-driver"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.task-eia.optimized-cpu"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.none"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.ecr-endpoint"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.docker-plugin.local"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.task-cpu-mem-limit"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.ssm.bootstrap.log-driver"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.efsAuth"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.30"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.full-sync"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.31"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.32"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.fluentd"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.options.config.file"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.availability-zone", 
2021-06-25T07:45:54Z                     "value": "ap-south-1b"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.aws-appmesh"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.24"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.25"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.26"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.27"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.privileged-container"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.28"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.29"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.cpu-architecture", 
2021-06-25T07:45:54Z                     "value": "x86_64"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.ecr-auth"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.fluentbit"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.20"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.os-type", 
2021-06-25T07:45:54Z                     "value": "linux"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.21"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.22"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.task-eia"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.23"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.private-registry-authentication.secretsmanager"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.syslog"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awsfirelens"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.options.config.s3"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.logging-driver.json-file"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.execution-role-awslogs"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.17"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.firelens.fluentd"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.efs"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.execution-role-ecr-pull"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.container-health-check"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.instance-type", 
2021-06-25T07:45:54Z                     "value": "t2.micro"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.task-iam-role-network-host"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.container-ordering"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.env-files.s3"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.secrets.ssm.environment-variables"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "ecs.capability.pid-ipc-namespace-sharing"
2021-06-25T07:45:54Z                 }, 
2021-06-25T07:45:54Z                 {
2021-06-25T07:45:54Z                     "name": "com.amazonaws.ecs.capability.task-iam-role"
2021-06-25T07:45:54Z                 }
2021-06-25T07:45:54Z             ], 
2021-06-25T07:45:54Z             "versionInfo": {
2021-06-25T07:45:54Z                 "agentVersion": "1.51.0", 
2021-06-25T07:45:54Z                 "agentHash": "5c821610", 
2021-06-25T07:45:54Z                 "dockerVersion": "DockerVersion: 19.03.13-ce"
2021-06-25T07:45:54Z             }, 
2021-06-25T07:45:54Z             "runningTasksCount": 0, 
2021-06-25T07:45:54Z             "attachments": []
2021-06-25T07:45:54Z         }
2021-06-25T07:45:54Z     ]
2021-06-25T07:45:54Z }'
2021-06-25T07:45:54Z + local EB_CONFIG_ECS_AGENT_CONNECTED=true
2021-06-25T07:45:54Z + local TIMEOUT=20
2021-06-25T07:45:54Z + '[' true = true ']'
2021-06-25T07:45:54Z + set -e
2021-06-25T07:45:54Z + trace 'Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.'
2021-06-25T07:45:54Z + echo 'Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.'
2021-06-25T07:45:54Z Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.
2021-06-25T07:45:54Z + eventHelper.py --msg 'Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.' --severity TRACE
2021-06-25T07:45:54Z + set +e
2021-06-25T07:45:54Z + local ECS_RESPONSE
2021-06-25T07:45:54Z ++ aws ecs start-task --cluster awseb-Bye-env-m44xgakxkp --task-definition awseb-Bye-env-m44xgakxkp:2 --container-instances arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:45:55Z + ECS_RESPONSE='{
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }'
2021-06-25T07:45:55Z + local ECS_EXIT=0
2021-06-25T07:45:55Z ++ jq -r '.tasks[0].taskArn'
2021-06-25T07:45:55Z ++ echo '{
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }'
2021-06-25T07:45:55Z + local EB_CONFIG_ECS_TASK_ARN=null
2021-06-25T07:45:55Z + '[' 0 -ne 0 ']'
2021-06-25T07:45:55Z + '[' -z null ']'
2021-06-25T07:45:55Z + '[' null = null ']'
2021-06-25T07:45:55Z + error_exit 'Encountered error starting new ECS task: {
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }' 1
2021-06-25T07:45:55Z + error 'Encountered error starting new ECS task: {
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }'
2021-06-25T07:45:55Z + echo 'Encountered error starting new ECS task: {
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }'
2021-06-25T07:45:55Z Encountered error starting new ECS task: {
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }
2021-06-25T07:45:55Z + eventHelper.py --msg 'Encountered error starting new ECS task: {
2021-06-25T07:45:55Z     "failures": [
2021-06-25T07:45:55Z         {
2021-06-25T07:45:55Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:55Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:55Z         }
2021-06-25T07:45:55Z     ], 
2021-06-25T07:45:55Z     "tasks": []
2021-06-25T07:45:55Z }' --severity ERROR
2021-06-25T07:45:55Z + exit 1
2021-06-25T07:45:55Z + . /opt/elasticbeanstalk/hooks/common.sh
2021-06-25T07:45:55Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_cluster
2021-06-25T07:45:55Z + EB_CONFIG_ECS_CLUSTER=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:55Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:45:55Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:55Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_arn_file
2021-06-25T07:45:55Z + EB_CONFIG_ECS_TASK_ARN_FILE=/etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:45:55Z ++ /opt/elasticbeanstalk/bin/get-config container -k deployment_manifest
2021-06-25T07:45:55Z + EB_CONFIG_DEPLOYMENT_MANIFEST=/opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:55Z + '[' -f /opt/elasticbeanstalk/deploy/manifest ']'
2021-06-25T07:45:55Z ++ jq -r '.ECS.TaskDefinitionName | select(. != null)'
2021-06-25T07:45:55Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:55Z + EB_TASK_DEF_NAME_FROM_MANIFEST=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:55Z ++ jq -r '.ECS.TaskDefinitionRevision | select(. != null)'
2021-06-25T07:45:55Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:55Z + EB_TASK_DEF_REVISION_FROM_MANIFEST=2
2021-06-25T07:45:55Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:55Z + '[' -z 2 ']'
2021-06-25T07:45:55Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp:2
2021-06-25T07:45:55Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:55Z + '[' -z awseb-Bye-env-m44xgakxkp:2 ']'
2021-06-25T07:45:55Z + CMD_GET_INSTANCE_ARN='curl -sS http://localhost:51678/v1/metadata | jq -r .ContainerInstanceArn'
2021-06-25T07:45:55Z + CMD_GET_KNOWN_STATUS='curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r .KnownStatus'
2021-06-25T07:45:55Z + CMD_DESCRIBE_INSTANCE='aws ecs describe-container-instances --cluster $EB_CONFIG_ECS_CLUSTER --container-instances $EB_CONFIG_ECS_INSTANCE_ARN 2>&1'
2021-06-25T07:45:55Z + case "$1" in
2021-06-25T07:45:55Z + stop_ecs_task
2021-06-25T07:45:55Z + '[' -f /etc/elasticbeanstalk/.ecs-task-arn ']'
2021-06-25T07:45:55Z ++ cat /etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:45:55Z + local EB_CONFIG_ECS_TASK_ARN=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:45:55Z + trace 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.'
2021-06-25T07:45:55Z + echo 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.'
2021-06-25T07:45:55Z Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.
2021-06-25T07:45:55Z + eventHelper.py --msg 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.' --severity TRACE
2021-06-25T07:45:55Z + set +e
2021-06-25T07:45:55Z + local ECS_RESPONSE
2021-06-25T07:45:55Z ++ aws ecs stop-task --cluster awseb-Bye-env-m44xgakxkp --task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:45:56Z + ECS_RESPONSE='{
2021-06-25T07:45:56Z     "task": {
2021-06-25T07:45:56Z         "launchType": "EC2", 
2021-06-25T07:45:56Z         "attachments": [], 
2021-06-25T07:45:56Z         "stoppingAt": 1624607150.105, 
2021-06-25T07:45:56Z         "clusterArn": "arn:aws:ecs:ap-south-1:215680092654:cluster/awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:45:56Z         "desiredStatus": "STOPPED", 
2021-06-25T07:45:56Z         "createdAt": 1624606679.971, 
2021-06-25T07:45:56Z         "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:45:56Z         "group": "family:awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:45:56Z         "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:45:56Z         "pullStartedAt": 1624606681.038, 
2021-06-25T07:45:56Z         "version": 5, 
2021-06-25T07:45:56Z         "stopCode": "UserInitiated", 
2021-06-25T07:45:56Z         "connectivityAt": 1624606679.971, 
2021-06-25T07:45:56Z         "startedAt": 1624606704.771, 
2021-06-25T07:45:56Z         "taskDefinitionArn": "arn:aws:ecs:ap-south-1:215680092654:task-definition/awseb-Bye-env-m44xgakxkp:1", 
2021-06-25T07:45:56Z         "containers": [], 
2021-06-25T07:45:56Z         "availabilityZone": "ap-south-1b", 
2021-06-25T07:45:56Z         "tags": [], 
2021-06-25T07:45:56Z         "executionStoppedAt": 1624607151.41, 
2021-06-25T07:45:56Z         "memory": "256", 
2021-06-25T07:45:56Z         "lastStatus": "STOPPED", 
2021-06-25T07:45:56Z         "connectivity": "CONNECTED", 
2021-06-25T07:45:56Z         "overrides": {
2021-06-25T07:45:56Z             "inferenceAcceleratorOverrides": [], 
2021-06-25T07:45:56Z             "containerOverrides": []
2021-06-25T07:45:56Z         }, 
2021-06-25T07:45:56Z         "pullStoppedAt": 1624606704.509, 
2021-06-25T07:45:56Z         "stoppedAt": 1624607151.689, 
2021-06-25T07:45:56Z         "stoppedReason": "Task stopped by user", 
2021-06-25T07:45:56Z         "cpu": "0"
2021-06-25T07:45:56Z     }
2021-06-25T07:45:56Z }'
2021-06-25T07:45:56Z + '[' 0 -ne 0 ']'
2021-06-25T07:45:56Z + set -e
2021-06-25T07:45:56Z + local STOP_TIMEOUT=120
2021-06-25T07:45:56Z + local TIMEOUT=120
2021-06-25T07:45:56Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:45:56Z +++ jq -r .KnownStatus
2021-06-25T07:45:56Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:45:56Z + local KNOWN_STATUS=STOPPED
2021-06-25T07:45:56Z + '[' STOPPED '!=' STOPPED ']'
2021-06-25T07:45:56Z + trace 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.'
2021-06-25T07:45:56Z + echo 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.'
2021-06-25T07:45:56Z ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.
2021-06-25T07:45:56Z + eventHelper.py --msg 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.' --severity TRACE
2021-06-25T07:45:56Z + TIMEOUT=60
2021-06-25T07:45:56Z ++ wc -l
2021-06-25T07:45:56Z ++ docker ps -q
2021-06-25T07:45:56Z + '[' 1 '!=' 1 ']'
2021-06-25T07:45:56Z + exit 0
2021-06-25T07:45:58Z + . /opt/elasticbeanstalk/hooks/common.sh
2021-06-25T07:45:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_cluster
2021-06-25T07:45:58Z + EB_CONFIG_ECS_CLUSTER=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:45:58Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_arn_file
2021-06-25T07:45:58Z + EB_CONFIG_ECS_TASK_ARN_FILE=/etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:45:58Z ++ /opt/elasticbeanstalk/bin/get-config container -k deployment_manifest
2021-06-25T07:45:58Z + EB_CONFIG_DEPLOYMENT_MANIFEST=/opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:58Z + '[' -f /opt/elasticbeanstalk/deploy/manifest ']'
2021-06-25T07:45:58Z ++ jq -r '.ECS.TaskDefinitionName | select(. != null)'
2021-06-25T07:45:58Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:58Z + EB_TASK_DEF_NAME_FROM_MANIFEST=awseb-Bye-env-m44xgakxkp
2021-06-25T07:45:58Z ++ jq -r '.ECS.TaskDefinitionRevision | select(. != null)'
2021-06-25T07:45:58Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:45:58Z + EB_TASK_DEF_REVISION_FROM_MANIFEST=2
2021-06-25T07:45:58Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:58Z + '[' -z 2 ']'
2021-06-25T07:45:58Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp:2
2021-06-25T07:45:58Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:45:58Z + '[' -z awseb-Bye-env-m44xgakxkp:2 ']'
2021-06-25T07:45:58Z + CMD_GET_INSTANCE_ARN='curl -sS http://localhost:51678/v1/metadata | jq -r .ContainerInstanceArn'
2021-06-25T07:45:58Z + CMD_GET_KNOWN_STATUS='curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r .KnownStatus'
2021-06-25T07:45:58Z + CMD_DESCRIBE_INSTANCE='aws ecs describe-container-instances --cluster $EB_CONFIG_ECS_CLUSTER --container-instances $EB_CONFIG_ECS_INSTANCE_ARN 2>&1'
2021-06-25T07:45:58Z + case "$1" in
2021-06-25T07:45:58Z + start_ecs_task
2021-06-25T07:45:58Z ++ eval curl -sS http://localhost:51678/v1/metadata '|' jq -r .ContainerInstanceArn
2021-06-25T07:45:58Z +++ jq -r .ContainerInstanceArn
2021-06-25T07:45:58Z +++ curl -sS http://localhost:51678/v1/metadata
2021-06-25T07:45:58Z + local EB_CONFIG_ECS_INSTANCE_ARN=arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:45:58Z + local TIMEOUT=10
2021-06-25T07:45:58Z + '[' -n arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900 ']'
2021-06-25T07:45:58Z + '[' arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900 '!=' null ']'
2021-06-25T07:45:58Z + set +e
2021-06-25T07:45:58Z + local ECS_RESPONSE
2021-06-25T07:45:58Z ++ eval aws ecs describe-container-instances --cluster '$EB_CONFIG_ECS_CLUSTER' --container-instances '$EB_CONFIG_ECS_INSTANCE_ARN' '2>&1'
2021-06-25T07:45:58Z +++ aws ecs describe-container-instances --cluster awseb-Bye-env-m44xgakxkp --container-instances arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:45:59Z + ECS_RESPONSE='{
2021-06-25T07:45:59Z     "failures": [], 
2021-06-25T07:45:59Z     "containerInstances": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "status": "ACTIVE", 
2021-06-25T07:45:59Z             "registeredAt": 1624606625.787, 
2021-06-25T07:45:59Z             "registeredResources": [
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 1024, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "CPU", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 985, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "MEMORY", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [
2021-06-25T07:45:59Z                         "22", 
2021-06-25T07:45:59Z                         "2376", 
2021-06-25T07:45:59Z                         "2375", 
2021-06-25T07:45:59Z                         "51678", 
2021-06-25T07:45:59Z                         "51679"
2021-06-25T07:45:59Z                     ], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }
2021-06-25T07:45:59Z             ], 
2021-06-25T07:45:59Z             "ec2InstanceId": "i-0637a7a81c7137fa2", 
2021-06-25T07:45:59Z             "tags": [], 
2021-06-25T07:45:59Z             "agentConnected": true, 
2021-06-25T07:45:59Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:45:59Z             "pendingTasksCount": 0, 
2021-06-25T07:45:59Z             "remainingResources": [
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 1024, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "CPU", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 985, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "MEMORY", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [
2021-06-25T07:45:59Z                         "22", 
2021-06-25T07:45:59Z                         "2376", 
2021-06-25T07:45:59Z                         "2375", 
2021-06-25T07:45:59Z                         "51678", 
2021-06-25T07:45:59Z                         "51679"
2021-06-25T07:45:59Z                     ], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }
2021-06-25T07:45:59Z             ], 
2021-06-25T07:45:59Z             "version": 5, 
2021-06-25T07:45:59Z             "attributes": [
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.asm.environment-variables"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.ami-id", 
2021-06-25T07:45:59Z                     "value": "ami-0e11fa7aac92a9b5a"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.asm.bootstrap.log-driver"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.task-eia.optimized-cpu"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.none"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.ecr-endpoint"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.docker-plugin.local"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.task-cpu-mem-limit"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.ssm.bootstrap.log-driver"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.efsAuth"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.30"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.full-sync"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.31"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.32"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.fluentd"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.options.config.file"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.availability-zone", 
2021-06-25T07:45:59Z                     "value": "ap-south-1b"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.aws-appmesh"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.24"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.25"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.26"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.27"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.privileged-container"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.28"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.29"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.cpu-architecture", 
2021-06-25T07:45:59Z                     "value": "x86_64"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.ecr-auth"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.fluentbit"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.20"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.os-type", 
2021-06-25T07:45:59Z                     "value": "linux"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.21"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.22"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.task-eia"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.23"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.private-registry-authentication.secretsmanager"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.syslog"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awsfirelens"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.options.config.s3"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.json-file"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.execution-role-awslogs"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.17"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.fluentd"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.efs"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.execution-role-ecr-pull"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.container-health-check"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.instance-type", 
2021-06-25T07:45:59Z                     "value": "t2.micro"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role-network-host"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.container-ordering"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.env-files.s3"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.ssm.environment-variables"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.pid-ipc-namespace-sharing"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role"
2021-06-25T07:45:59Z                 }
2021-06-25T07:45:59Z             ], 
2021-06-25T07:45:59Z             "versionInfo": {
2021-06-25T07:45:59Z                 "agentVersion": "1.51.0", 
2021-06-25T07:45:59Z                 "agentHash": "5c821610", 
2021-06-25T07:45:59Z                 "dockerVersion": "DockerVersion: 19.03.13-ce"
2021-06-25T07:45:59Z             }, 
2021-06-25T07:45:59Z             "runningTasksCount": 0, 
2021-06-25T07:45:59Z             "attachments": []
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ]
2021-06-25T07:45:59Z }'
2021-06-25T07:45:59Z + '[' 0 -ne 0 ']'
2021-06-25T07:45:59Z ++ jq -r '.containerInstances[0].agentConnected'
2021-06-25T07:45:59Z ++ echo '{
2021-06-25T07:45:59Z     "failures": [], 
2021-06-25T07:45:59Z     "containerInstances": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "status": "ACTIVE", 
2021-06-25T07:45:59Z             "registeredAt": 1624606625.787, 
2021-06-25T07:45:59Z             "registeredResources": [
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 1024, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "CPU", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 985, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "MEMORY", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [
2021-06-25T07:45:59Z                         "22", 
2021-06-25T07:45:59Z                         "2376", 
2021-06-25T07:45:59Z                         "2375", 
2021-06-25T07:45:59Z                         "51678", 
2021-06-25T07:45:59Z                         "51679"
2021-06-25T07:45:59Z                     ], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }
2021-06-25T07:45:59Z             ], 
2021-06-25T07:45:59Z             "ec2InstanceId": "i-0637a7a81c7137fa2", 
2021-06-25T07:45:59Z             "tags": [], 
2021-06-25T07:45:59Z             "agentConnected": true, 
2021-06-25T07:45:59Z             "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:45:59Z             "pendingTasksCount": 0, 
2021-06-25T07:45:59Z             "remainingResources": [
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 1024, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "CPU", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "integerValue": 985, 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "type": "INTEGER", 
2021-06-25T07:45:59Z                     "name": "MEMORY", 
2021-06-25T07:45:59Z                     "doubleValue": 0.0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [
2021-06-25T07:45:59Z                         "22", 
2021-06-25T07:45:59Z                         "2376", 
2021-06-25T07:45:59Z                         "2375", 
2021-06-25T07:45:59Z                         "51678", 
2021-06-25T07:45:59Z                         "51679"
2021-06-25T07:45:59Z                     ], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "PORTS_UDP", 
2021-06-25T07:45:59Z                     "longValue": 0, 
2021-06-25T07:45:59Z                     "doubleValue": 0.0, 
2021-06-25T07:45:59Z                     "stringSetValue": [], 
2021-06-25T07:45:59Z                     "type": "STRINGSET", 
2021-06-25T07:45:59Z                     "integerValue": 0
2021-06-25T07:45:59Z                 }
2021-06-25T07:45:59Z             ], 
2021-06-25T07:45:59Z             "version": 5, 
2021-06-25T07:45:59Z             "attributes": [
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.asm.environment-variables"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.ami-id", 
2021-06-25T07:45:59Z                     "value": "ami-0e11fa7aac92a9b5a"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.asm.bootstrap.log-driver"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.task-eia.optimized-cpu"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.none"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.ecr-endpoint"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.docker-plugin.local"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.task-cpu-mem-limit"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.ssm.bootstrap.log-driver"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.efsAuth"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.30"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.full-sync"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.31"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.32"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.fluentd"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.options.config.file"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.availability-zone", 
2021-06-25T07:45:59Z                     "value": "ap-south-1b"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.aws-appmesh"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.24"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.25"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.26"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.27"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.privileged-container"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.28"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.29"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.cpu-architecture", 
2021-06-25T07:45:59Z                     "value": "x86_64"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.ecr-auth"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.fluentbit"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.20"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.os-type", 
2021-06-25T07:45:59Z                     "value": "linux"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.21"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.22"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.task-eia"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.23"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.private-registry-authentication.secretsmanager"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.syslog"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.awsfirelens"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.options.config.s3"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.logging-driver.json-file"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.execution-role-awslogs"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.17"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.firelens.fluentd"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.efs"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.execution-role-ecr-pull"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.container-health-check"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.instance-type", 
2021-06-25T07:45:59Z                     "value": "t2.micro"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role-network-host"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.container-ordering"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.env-files.s3"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.secrets.ssm.environment-variables"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "ecs.capability.pid-ipc-namespace-sharing"
2021-06-25T07:45:59Z                 }, 
2021-06-25T07:45:59Z                 {
2021-06-25T07:45:59Z                     "name": "com.amazonaws.ecs.capability.task-iam-role"
2021-06-25T07:45:59Z                 }
2021-06-25T07:45:59Z             ], 
2021-06-25T07:45:59Z             "versionInfo": {
2021-06-25T07:45:59Z                 "agentVersion": "1.51.0", 
2021-06-25T07:45:59Z                 "agentHash": "5c821610", 
2021-06-25T07:45:59Z                 "dockerVersion": "DockerVersion: 19.03.13-ce"
2021-06-25T07:45:59Z             }, 
2021-06-25T07:45:59Z             "runningTasksCount": 0, 
2021-06-25T07:45:59Z             "attachments": []
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ]
2021-06-25T07:45:59Z }'
2021-06-25T07:45:59Z + local EB_CONFIG_ECS_AGENT_CONNECTED=true
2021-06-25T07:45:59Z + local TIMEOUT=20
2021-06-25T07:45:59Z + '[' true = true ']'
2021-06-25T07:45:59Z + set -e
2021-06-25T07:45:59Z + trace 'Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.'
2021-06-25T07:45:59Z + echo 'Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.'
2021-06-25T07:45:59Z Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.
2021-06-25T07:45:59Z + eventHelper.py --msg 'Starting new ECS task with awseb-Bye-env-m44xgakxkp:2.' --severity TRACE
2021-06-25T07:45:59Z + set +e
2021-06-25T07:45:59Z + local ECS_RESPONSE
2021-06-25T07:45:59Z ++ aws ecs start-task --cluster awseb-Bye-env-m44xgakxkp --task-definition awseb-Bye-env-m44xgakxkp:2 --container-instances arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900
2021-06-25T07:45:59Z + ECS_RESPONSE='{
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }'
2021-06-25T07:45:59Z + local ECS_EXIT=0
2021-06-25T07:45:59Z ++ jq -r '.tasks[0].taskArn'
2021-06-25T07:45:59Z ++ echo '{
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }'
2021-06-25T07:45:59Z + local EB_CONFIG_ECS_TASK_ARN=null
2021-06-25T07:45:59Z + '[' 0 -ne 0 ']'
2021-06-25T07:45:59Z + '[' -z null ']'
2021-06-25T07:45:59Z + '[' null = null ']'
2021-06-25T07:45:59Z + error_exit 'Encountered error starting new ECS task: {
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }' 1
2021-06-25T07:45:59Z + error 'Encountered error starting new ECS task: {
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }'
2021-06-25T07:45:59Z + echo 'Encountered error starting new ECS task: {
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }'
2021-06-25T07:45:59Z Encountered error starting new ECS task: {
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }
2021-06-25T07:45:59Z + eventHelper.py --msg 'Encountered error starting new ECS task: {
2021-06-25T07:45:59Z     "failures": [
2021-06-25T07:45:59Z         {
2021-06-25T07:45:59Z             "reason": "RESOURCE:MEMORY", 
2021-06-25T07:45:59Z             "arn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/d7938ed6cc6c41ebba249b1b32525900"
2021-06-25T07:45:59Z         }
2021-06-25T07:45:59Z     ], 
2021-06-25T07:45:59Z     "tasks": []
2021-06-25T07:45:59Z }' --severity ERROR
2021-06-25T07:45:59Z + exit 1
2021-06-25T07:45:59Z + . /opt/elasticbeanstalk/hooks/common.sh
2021-06-25T07:45:59Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_cluster
2021-06-25T07:46:00Z + EB_CONFIG_ECS_CLUSTER=awseb-Bye-env-m44xgakxkp
2021-06-25T07:46:00Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_def
2021-06-25T07:46:00Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp
2021-06-25T07:46:00Z ++ /opt/elasticbeanstalk/bin/get-config container -k ecs_task_arn_file
2021-06-25T07:46:00Z + EB_CONFIG_ECS_TASK_ARN_FILE=/etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:46:00Z ++ /opt/elasticbeanstalk/bin/get-config container -k deployment_manifest
2021-06-25T07:46:00Z + EB_CONFIG_DEPLOYMENT_MANIFEST=/opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:46:00Z + '[' -f /opt/elasticbeanstalk/deploy/manifest ']'
2021-06-25T07:46:00Z ++ jq -r '.ECS.TaskDefinitionName | select(. != null)'
2021-06-25T07:46:00Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:46:00Z + EB_TASK_DEF_NAME_FROM_MANIFEST=awseb-Bye-env-m44xgakxkp
2021-06-25T07:46:00Z ++ jq -r '.ECS.TaskDefinitionRevision | select(. != null)'
2021-06-25T07:46:00Z ++ cat /opt/elasticbeanstalk/deploy/manifest
2021-06-25T07:46:00Z + EB_TASK_DEF_REVISION_FROM_MANIFEST=2
2021-06-25T07:46:00Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:46:00Z + '[' -z 2 ']'
2021-06-25T07:46:00Z + EB_CONFIG_ECS_TASK_DEF=awseb-Bye-env-m44xgakxkp:2
2021-06-25T07:46:00Z + '[' -z awseb-Bye-env-m44xgakxkp ']'
2021-06-25T07:46:00Z + '[' -z awseb-Bye-env-m44xgakxkp:2 ']'
2021-06-25T07:46:00Z + CMD_GET_INSTANCE_ARN='curl -sS http://localhost:51678/v1/metadata | jq -r .ContainerInstanceArn'
2021-06-25T07:46:00Z + CMD_GET_KNOWN_STATUS='curl -sS http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN | jq -r .KnownStatus'
2021-06-25T07:46:00Z + CMD_DESCRIBE_INSTANCE='aws ecs describe-container-instances --cluster $EB_CONFIG_ECS_CLUSTER --container-instances $EB_CONFIG_ECS_INSTANCE_ARN 2>&1'
2021-06-25T07:46:00Z + case "$1" in
2021-06-25T07:46:00Z + stop_ecs_task
2021-06-25T07:46:00Z + '[' -f /etc/elasticbeanstalk/.ecs-task-arn ']'
2021-06-25T07:46:00Z ++ cat /etc/elasticbeanstalk/.ecs-task-arn
2021-06-25T07:46:00Z + local EB_CONFIG_ECS_TASK_ARN=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:46:00Z + trace 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.'
2021-06-25T07:46:00Z + echo 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.'
2021-06-25T07:46:00Z Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.
2021-06-25T07:46:00Z + eventHelper.py --msg 'Stopping ECS task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9.' --severity TRACE
2021-06-25T07:46:00Z + set +e
2021-06-25T07:46:00Z + local ECS_RESPONSE
2021-06-25T07:46:00Z ++ aws ecs stop-task --cluster awseb-Bye-env-m44xgakxkp --task arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9
2021-06-25T07:46:00Z + ECS_RESPONSE='{
2021-06-25T07:46:00Z     "task": {
2021-06-25T07:46:00Z         "launchType": "EC2", 
2021-06-25T07:46:00Z         "attachments": [], 
2021-06-25T07:46:00Z         "stoppingAt": 1624607150.105, 
2021-06-25T07:46:00Z         "clusterArn": "arn:aws:ecs:ap-south-1:215680092654:cluster/awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:46:00Z         "desiredStatus": "STOPPED", 
2021-06-25T07:46:00Z         "createdAt": 1624606679.971, 
2021-06-25T07:46:00Z         "taskArn": "arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9", 
2021-06-25T07:46:00Z         "group": "family:awseb-Bye-env-m44xgakxkp", 
2021-06-25T07:46:00Z         "containerInstanceArn": "arn:aws:ecs:ap-south-1:215680092654:container-instance/awseb-Bye-env-m44xgakxkp/d7938ed6cc6c41ebba249b1b32525900", 
2021-06-25T07:46:00Z         "pullStartedAt": 1624606681.038, 
2021-06-25T07:46:00Z         "version": 5, 
2021-06-25T07:46:00Z         "stopCode": "UserInitiated", 
2021-06-25T07:46:00Z         "connectivityAt": 1624606679.971, 
2021-06-25T07:46:00Z         "startedAt": 1624606704.771, 
2021-06-25T07:46:00Z         "taskDefinitionArn": "arn:aws:ecs:ap-south-1:215680092654:task-definition/awseb-Bye-env-m44xgakxkp:1", 
2021-06-25T07:46:00Z         "containers": [], 
2021-06-25T07:46:00Z         "availabilityZone": "ap-south-1b", 
2021-06-25T07:46:00Z         "tags": [], 
2021-06-25T07:46:00Z         "executionStoppedAt": 1624607151.41, 
2021-06-25T07:46:00Z         "memory": "256", 
2021-06-25T07:46:00Z         "lastStatus": "STOPPED", 
2021-06-25T07:46:00Z         "connectivity": "CONNECTED", 
2021-06-25T07:46:00Z         "overrides": {
2021-06-25T07:46:00Z             "inferenceAcceleratorOverrides": [], 
2021-06-25T07:46:00Z             "containerOverrides": []
2021-06-25T07:46:00Z         }, 
2021-06-25T07:46:00Z         "pullStoppedAt": 1624606704.509, 
2021-06-25T07:46:00Z         "stoppedAt": 1624607151.689, 
2021-06-25T07:46:00Z         "stoppedReason": "Task stopped by user", 
2021-06-25T07:46:00Z         "cpu": "0"
2021-06-25T07:46:00Z     }
2021-06-25T07:46:00Z }'
2021-06-25T07:46:00Z + '[' 0 -ne 0 ']'
2021-06-25T07:46:00Z + set -e
2021-06-25T07:46:00Z + local STOP_TIMEOUT=120
2021-06-25T07:46:00Z + local TIMEOUT=120
2021-06-25T07:46:00Z ++ eval curl -sS 'http://localhost:51678/v1/tasks?taskarn=$EB_CONFIG_ECS_TASK_ARN' '|' jq -r .KnownStatus
2021-06-25T07:46:00Z +++ jq -r .KnownStatus
2021-06-25T07:46:00Z +++ curl -sS 'http://localhost:51678/v1/tasks?taskarn=arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9'
2021-06-25T07:46:00Z + local KNOWN_STATUS=STOPPED
2021-06-25T07:46:00Z + '[' STOPPED '!=' STOPPED ']'
2021-06-25T07:46:00Z + trace 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.'
2021-06-25T07:46:00Z + echo 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.'
2021-06-25T07:46:00Z ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.
2021-06-25T07:46:00Z + eventHelper.py --msg 'ECS task: arn:aws:ecs:ap-south-1:215680092654:task/awseb-Bye-env-m44xgakxkp/de8dd9ed366042daa72e22d432eef6c9 is STOPPED.' --severity TRACE
2021-06-25T07:46:00Z + TIMEOUT=60
2021-06-25T07:46:00Z ++ wc -l
2021-06-25T07:46:00Z ++ docker ps -q
2021-06-25T07:46:00Z + '[' 1 '!=' 1 ']'
2021-06-25T07:46:00Z + exit 0
